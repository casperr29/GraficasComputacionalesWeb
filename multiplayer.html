<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
      I
    />
    <link rel="stylesheet" href="css/multiplayer.css" />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    

    <script type="module" id="lvl1">
      import * as THREE from "/js/three.module.js";
      import { OrbitControls } from "/js/OrbitControls.js";
      import { GLTFLoader } from "/js/GLTFLoader.js";
      import { FBXLoader } from "/js/FBXLoader.js";

      ////////////////////////variables////////////////////////
      var clock, deltaTime;
      var miniWindowSize = { width: 1280, height: 720 };

      var right1=false,left1=false,right2=false,left2=false;
      ////////////////////////loaders////////////////////////
      const backgroundLoader = new THREE.TextureLoader();
      const fbxLoader = new FBXLoader();
      const gltfLoader = new GLTFLoader();

      ////////////////////////setup scene////////////////////////
      clock = new THREE.Clock();
      const scene = new THREE.Scene();
      scene.background = backgroundLoader.load('/imagenes/MPFondo.png');
      const camera = new THREE.PerspectiveCamera(50, miniWindowSize.width / miniWindowSize.height);
      camera.position.set(0, 0, 180);

      const renderer = new THREE.WebGLRenderer();
      renderer.setSize(miniWindowSize.width, miniWindowSize.height);
      document.body.appendChild(renderer.domElement);
      //const cameraControl = new OrbitControls(camera, renderer.domElement)

     
    

      ////// Players //////

      fbxLoader.load(
          '/assets/free_car_1.fbx',
          (rover) => {
              rover.position.set(65, -75, 0);
              scene.add(rover);
              rover.name = "rover";

          }
      );

      fbxLoader.load(
          '/assets/free_car_1.fbx',
          (lolly) => {
              lolly.position.set(-65, -75, 0);
              scene.add(lolly);
              lolly.name = "lolly";

          }
      );

      ////////////////////////luces////////////////////////
      const directionalLight = new THREE.DirectionalLight(0xFFFFFF);
      directionalLight.position.set(30, 30, 0);
      //scene.add(directionalLight);
      const ambientlight = new THREE.AmbientLight();
      scene.add(ambientlight);

      ////////////////////////movement////////////////////////
      function movis(obj1, obj2) {
          document.onkeydown = function (e) {
              
              if (e.keyCode === 37) {
                  
                  left1=true;
              }
              if (e.keyCode === 39) {
                 
                  right1=true;
              }
              if (e.keyCode === 65) {
                 
                  left2=true;
              }
              if (e.keyCode === 68) {
                  
                  right2=true;
              }
          }
          document.onkeyup = function (e) {
              
              if (e.keyCode === 37) {
                  left1=false;
              }
              if (e.keyCode === 39) {
                  right1=false;
              }
              if (e.keyCode === 65) {
                  left2=false;
              }
              if (e.keyCode === 68) {
                  right2=false;
              }
          }
      }
    /*   function movis(obj1, obj2) {
          document.onkeydown = function (e) {
              if (e.keyCode === 37) {
                  obj1.position.x -= 2;
                  obj1.rotation.y = Math.PI / -2;
                  if (obj1.position.x < -125) {
                      obj1.position.x = -125;
                  }
              }
              if (e.keyCode === 39) {
                  obj1.position.x += 2;
                  obj1.rotation.y = Math.PI / 2;
                  if (obj1.position.x > 125) {
                      obj1.position.x = 125;
                  }
              }
              if (e.keyCode === 65) {
                  obj2.position.x -= 2;
                  obj2.rotation.y = Math.PI / -2;
                  if (obj2.position.x < -125) {
                      obj2.position.x = -125;
                  }
              }
              if (e.keyCode === 68) {
                  obj2.position.x += 2;
                  obj2.rotation.y = Math.PI / 2;
                  if (obj2.position.x > 125) {
                      obj2.position.x = 125;
                  }
              }
          }
      } */
      

      function animate() {
          requestAnimationFrame(animate);
          //character.rotation.x += 0.01;
          //character.rotation.y += 0.01;
          var rover = scene.getObjectByName('rover');
          var lolly = scene.getObjectByName('lolly');
          movis(rover,lolly);

         
          if (left1==true) {
              rover.position.x -= 1;
                  if (rover.position.x < -125) {                  
                      rover.position.x = -125;
                  }
              }
              if (right1==true) {
                  rover.position.x += 1;
                  if (rover.position.x > 125) {
                      rover.position.x = 125;
                  }
              }
              if (left2==true) {
                  lolly.position.x -= 1;
                  if (lolly.position.x < -125) {
                      lolly.position.x = -125;
                  }
              }
              if (right2==true) {
                  lolly.position.x += 1;
                  if (lolly.position.x > 125) {
                      lolly.position.x = 125;
                  }
              }
          renderer.render(scene, camera);
      }

      animate();
  </script>


    <div
      id="inferior"
      class="d-flex flex-row align-items-center justify-content-between"
    >
    <div class="d-flex flex-column justify-content-center align-items-center">
      <h2 class="text-light text-center">Tiempo</h2>
      <h3 class="text-light text-center">01:02</h3>
    </div>

      <div class="d-flex flex-column justify-content-center align-items-center">
        <h2 class="text-light text-center">Power-Up</h2>
        <img id="powerup-img" src="imagenes/powerup.png" alt="powerup" />
      </div>

      <div class="d-flex flex-column justify-content-center align-items-center">
        <h2 class="text-light text-center">Puntuaci√≥n</h2>
        <h3 class="text-light text-center">1000000000</h3>
      </div>

      <!-- <i class="bx bx-time"></i> -->
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"
    ></script>
  </body>
</html>